var xe=Object.defineProperty,ye=Object.defineProperties;var Me=Object.getOwnPropertyDescriptors;var ee=Object.getOwnPropertySymbols;var Ce=Object.prototype.hasOwnProperty,Se=Object.prototype.propertyIsEnumerable;var ae=(n,c,s)=>c in n?xe(n,c,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[c]=s,P=(n,c)=>{for(var s in c||(c={}))Ce.call(c,s)&&ae(n,s,c[s]);if(ee)for(var s of ee(c))Se.call(c,s)&&ae(n,s,c[s]);return n},R=(n,c)=>ye(n,Me(c));import{d as Y,c as H,o as v,a as p,f as _,F as b,r as I,n as X,t as L,u as te,k as be,b as A,p as se,e as oe,_ as j,m as Ie,j as i,h as He,w as Ve,q as T}from"./index-f7BEabQq.js";const ne=["","A","2","3","4","5","6","7","8","9","10","J","Q","K"],$e={black:"#303133",red:"#f56c6c"},ze=["spades","heart","club","diamond"],le={spades:"♠",heart:"♥",club:"♣",diamond:"♦"},Oe={spades:"black",heart:"red",club:"black",diamond:"red"},Le=(n=0)=>{const c=ne.length,s=[];return ze.forEach(m=>{for(let d=1;d<c;d++)s.push({index:d,type:m,color:Oe[m],state:n})}),s},Te=n=>(se("data-v-1e2bcc12"),n=n(),oe(),n),De={class:"poker-card__front"},Ne={class:"poker-card__value"},Be={class:"type"},Ee={key:0,class:"poker-card__type"},Je={key:1,class:"poker-card__type"},We=Te(()=>_("div",{class:"poker-card__back"},null,-1)),Fe=Y({__name:"index",props:{card:{},width:{default:120},height:{default:180},shadow:{type:Boolean,default:!0}},setup(n){const c=n,s=H(()=>c.card.state===1),m=H(()=>{const{card:{color:C},width:f,height:k}=c;return{"--width":f+"px","--height":k+"px","--color":$e[C]}}),d=H(()=>c.card.type||"spades"),y=H(()=>{const C=c.card.index;return ne[C]||"A"});return(C,f)=>(v(),p("div",{class:X(["poker-card",{"is-active":s.value,shadow:C.shadow}]),style:A(m.value)},[_("div",De,[(v(),p(b,null,I(2,k=>_("div",{class:X(["poker-card__harf",`poker-card__${y.value}`])},[_("div",Ne,[_("span",Be,L(te(le)[d.value]),1),be(L(y.value),1)]),C.card.index<11?(v(),p("div",Ee,L(te(le)[d.value]),1)):(v(),p("div",Je,L(y.value),1))],2)),64))]),We],6))}}),Pe=j(Fe,[["__scopeId","data-v-1e2bcc12"]]),Re=Y({__name:"index",props:{width:{default:100},height:{default:150},data:{},shadow:{type:Boolean,default:!0}},setup(n){const c=s=>{const{top:m,left:d,z:y}=s;return{"--top":m+"px","--left":d+"px","z-index":y}};return(s,m)=>(v(),p("div",{class:"poker-card__wrap",style:A(c(s.data))},[Ie(Pe,{card:s.data.card,width:s.width,height:s.height,shadow:s.shadow},null,8,["card","width","height","shadow"])],4))}}),D=j(Re,[["__scopeId","data-v-a1dd2526"]]),Xe=n=>(se("data-v-2f756e70"),n=n(),oe(),n),Ye={class:"game poker"},Ae={class:"game-view__desktop"},je={class:"game-view__line"},qe={class:"game-view__footer"},Ge={class:"slots"},Ke={class:"slot"},Qe=Xe(()=>_("div",{class:"hand"},null,-1)),Ue={class:"game-view__slots"},Ze={class:"game-view__handout"},ea={class:"game-view__hand"},aa=Y({__name:"index",setup(n){const c=i(),s=i(980),m=i(800),d=i(36),y=i(160),C=H(()=>({"--width":s.value+"px","--height":m.value+"px","--padding":d.value+"px","--cardWidth":f.value+"px","--cardHeight":k.value+"px"})),f=i(100),k=i(150),V=i(32),ce=i(16),N=H(()=>f.value+ce.value),M=i([]),g=i([]),h=i([]),x=i([]),q=()=>{G();const e=Le();for(let t=0;t<7;t++){for(!h.value[t]&&(h.value[t]=[]);h.value[t].length<t+1;){const a=Math.round(Math.random()*(e.length-1)),l=h.value[t].length;h.value[t].push({z:l,top:l*V.value+d.value,left:t*N.value+y.value,card:e.splice(a,1)[0],line:t})}h.value[t][t].card.state=1}M.value=e.map((t,a)=>({top:m.value-k.value-d.value/2,left:s.value-f.value-d.value,card:t,z:e.length-a,line:-1})),ke()};He(q);const de=()=>{G();const{desktop:e,hand:t}=Z.value;h.value=e&&JSON.parse(e)||[],M.value=t&&JSON.parse(t)||[]},G=()=>{M.value=[],g.value=[],h.value=[],x.value=[[],[],[],[]]},B=i(!1),E=i(!1),ue=e=>{if(!e)return;const{top:t,left:a,line:l,card:u}=e,o=(a-y.value)/N.value;let r=Math.floor(o);o-r>2/3&&r++;let S=h.value[r];if(!S){J();return}const O=S.length*V.value+k.value,$=t>O,z=r===l,F=S[S.length-1],we=F&&(F.card.index!==u.index+1||F.card.color===u.color);if($||z||we){J();return}ie(l,r)},re=(e,t)=>{const a=x.value.findIndex(l=>l.length&&l[0].card.type===t);if(a!==-1){const l=x.value[a];return l[l.length-1].card.index===e-1?a:-1}return e!==1?-1:x.value.findIndex(l=>!l.length)},ve=(e,t)=>{var a;if((a=w.value)!=null&&a.length){const l=s.value-f.value,{x:u,y:o}=W.value;w.value.forEach((r,S)=>{const O=m.value-k.value-(w.value.length-1-S)*V.value,$=t-o+S*V.value,z=e-u;r.top=$<0?0:$>O?O:$,r.left=z<0?0:z>l?l:z,r.z=100+S})}},J=()=>{w.value.forEach(e=>{e.prev_left&&(e.left=e.prev_left),e.prev_top&&(e.top=e.prev_top)}),w.value=[]},ie=(e,t)=>{var u;if(B.value){const o=x.value[e];x.value[e]=o.splice(0,o.length-w.value.length)}else if(E.value)g.value.pop(),K();else{const o=h.value[e];h.value[e]=o.splice(0,o.length-w.value.length)}let a=h.value[t];a=[...a,...w.value],h.value[t]=a.map((o,r)=>(o=R(P({},o),{z:r,top:r*V.value+d.value,left:t*N.value+y.value,line:t}),o));const l=(u=h.value[e])==null?void 0:u.length;l&&(h.value[e][l-1].card.state=1)},he=(e,t,a)=>{if(a!==e.length-1)return;const{card:{type:l,index:u}}=t,o=re(u,l);o!==-1&&(t.top=m.value-k.value-d.value/2,t.left=o*(f.value+d.value/2)+d.value,t.z=x.value[o].length+1,t.line=o,e.pop(),x.value[o].push(t),e[e.length-1].card.state=1)},K=()=>{const e=g.value.length,t=s.value-d.value*3-f.value;g.value.forEach((a,l)=>{a.z=l,a.card.state=1,l<e-3?a.left=t-180:a.left=t-(e-l)*60})},w=i([]),W=i({x:0,y:0}),Q=(e,t,a,l,u)=>{const{card:{state:o}}=a;o&&(B.value=u,w.value=t.slice(l),w.value.forEach(r=>{r.prev_top=r.top,r.prev_left=r.left}),console.log(e.clientX,e.clientY),W.value={x:e.clientX-a.left,y:e.clientY-a.top})},pe=()=>{ue(w.value[0]),w.value=[],B.value=!1,E.value=!1},_e=e=>{ve(e.clientX,e.clientY)},fe=()=>{J()},U=(e,t,a)=>{he(e,t,a)},ge=()=>{if(M.value.length){const e=M.value.splice(0,3);g.value=[...g.value,...e],K()}else{const e=g.value.length;M.value=g.value.map((t,a)=>(t.card.state=0,R(P({},t),{top:m.value-d.value/2-k.value,left:s.value-d.value-f.value,z:e-a}))),g.value=[]}},me=(e,t)=>{if(t<g.value.length-1)return;E.value=!0;const a=g.value[t];a.prev_top=a.top,a.prev_left=a.left,w.value=[a],W.value={x:e.clientX-a.left,y:e.clientY-a.top}},Z=i({}),ke=()=>{Z.value={desktop:JSON.stringify(h.value),hand:JSON.stringify(M.value)}};return(e,t)=>(v(),p("div",Ye,[_("div",{ref_key:"gameView",ref:c,class:"game-view",style:A(C.value),onMousemove:_e,onMouseup:pe,onMouseleave:fe},[_("div",{class:"game-view__nav"},[_("div",{class:"button",onClick:q},"新游戏"),_("div",{class:"button",onClick:de},"重置")]),_("div",Ae,[(v(!0),p(b,null,I(h.value,(a,l)=>(v(),p("div",je,[(v(!0),p(b,null,I(a,(u,o)=>(v(),T(D,{data:u,width:f.value,height:k.value,onMousedown:r=>Q(r,a,u,o,!1),onDblclick:r=>U(a,u,o)},null,8,["data","width","height","onMousedown","onDblclick"]))),256))]))),256))]),_("div",qe,[_("div",Ge,[(v(!0),p(b,null,I(x.value,a=>(v(),p("div",Ke))),256))]),Qe]),(v(!0),p(b,null,I(x.value,a=>(v(),p("div",Ue,[(v(!0),p(b,null,I(a,(l,u)=>(v(),T(D,{data:l,width:f.value,height:k.value,shadow:!1,onMousedown:o=>Q(o,a,l,u,!0)},null,8,["data","width","height","onMousedown"]))),256))]))),256)),_("div",Ze,[(v(!0),p(b,null,I(g.value,(a,l)=>(v(),T(D,{data:a,width:f.value,height:k.value,shadow:l>g.value.length-3,onMousedown:u=>me(u,l),onDblclick:u=>U(g.value,a,l)},null,8,["data","width","height","shadow","onMousedown","onDblclick"]))),256))]),_("div",ea,[_("div",{class:X(["game-view__cover",{"is-empty":!M.value.length}]),onMousedown:Ve(ge,["stop"])},null,34),(v(!0),p(b,null,I(M.value,(a,l)=>(v(),T(D,{data:a,width:f.value,height:k.value},null,8,["data","width","height"]))),256))])],36)]))}}),sa=j(aa,[["__scopeId","data-v-2f756e70"]]);export{sa as default};
